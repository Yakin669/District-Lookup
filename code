<!DOCTYPE html>
<html>
<head>
    <title>District Lookup</title>
</head>
<body>

    <input type="text" id="keyInput" list="streetOptions" placeholder="Start typing a street..." oninput="document.getElementById('valueOutput').innerHTML = ''">
    <datalist id="streetOptions"></datalist>

    <button onclick="displayValueByKey()" style="background-color: #19D419; color:white; cursor:pointer;">Get Results</button>
    <button onclick="resetApp()" style="background-color: #f44336; color: white; cursor:pointer;">Clear Results</button>

    <p><span id="valueOutput"></span></p>

<script>
let locationData = [];

// 1. Fetch data using the PERMANENT raw link (No token needed)
async function loadData() {
    const url = 'https://raw.githubusercontent.com';
    try {
        const response = await fetch(url);
        if (!response.ok) throw new Error('Could not fetch data');
        locationData = await response.json();
        setupDatalist();
    } catch (error) {
        console.error('Error:', error);
        document.getElementById('valueOutput').innerText = "Error loading data. Make sure the file is public on GitHub.";
    }
}

// 2. Build the dropdown list
function setupDatalist() {
    const dataList = document.getElementById('streetOptions');
    dataList.innerHTML = ""; 
    locationData.forEach(item => {
        if(item.STREET) {
            let option = document.createElement('option');
            option.value = item.STREET;
            dataList.appendChild(option);
        }
    });
}

// 3. Find and Show Results
function displayValueByKey() {
    const input = document.getElementById('keyInput').value.trim().toLowerCase();
    const output = document.getElementById('valueOutput');
    
    if (!input) {
        output.textContent = "Please enter a street name.";
        return;
    }

    const result = locationData.find(loc => loc.STREET && loc.STREET.toLowerCase() === input);

    if (result) {
        // Handling keys with trailing spaces from your JSON
        const district = result["DISTRICT"] || "N/A";
        const village  = result["VILLAGE "] || result["VILLAGE"] || "N/A";
        const unit     = result["UNIT NUMBER"] || "N/A";
        const county   = result["COUNTY "] || result["COUNTY"] || "N/A";
        const type     = result["TYPE "] || "N/A";
        const villa    = result["VILLAS"] || result["VILLAS "] || "N/A";

        output.innerHTML = `
            <strong>District:</strong> ${district} <br>
            <strong>Village:</strong> ${village} <br>
            <strong>Villas:</strong> ${villa} <br>
            <strong>Type:</strong> ${type} <br>
            <strong>Unit:</strong> ${unit} <br>
            <strong>County:</strong> ${county}
        `;
    } else {
        output.textContent = "Street not found. Please select from the list.";
    }
}

// 4. Clear Everything
function resetApp() {
    document.getElementById('keyInput').value = "";
    document.getElementById('valueOutput').innerHTML = "";
    document.getElementById('keyInput').focus();
}

// Initialize on load
loadData();
</script>

</body>
</html>
